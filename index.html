<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=640, maximum-scale=1.0, user-scalable=yes">
    <title>Button Example</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="bluejelly.js"></script>
  </head>

<body>
<div class="container">
    <div class="title margin">
        <p id="title">Button Example</p>
        <p id="subtitle">Send '1' or '2' when button is pressed</p>
    </div>

    <div class="contents margin">
        <button id="button1" class="button">Button 1</button>
        <button id="button2" class="button">Button 2</button>
        <hr>
        <div id="device_name"> </div>
        <div id="uuid_name"> </div>
        <div id="status"> </div>  
    </div>
    <div class="footer margin">
        For more information, see <a href="https://jellyware.jp/kurage" target="_blank">jellyware.jp</a> and <a href="https://github.com/electricbaka/bluejelly" target="_blank">GitHub</a> !
    </div>
</div>
<script>
const ble = new BlueJelly();

window.onload = function () {
  ble.setUUID("UUID1", BlueJelly.BLEKEYBOARD_SERVICE, BlueJelly.BLEKEYBOARD_CHARACTER);
}

ble.onScan = function (deviceName) {
  document.getElementById('device_name').innerHTML = deviceName;
  document.getElementById('status').innerHTML = "found device!";
}

ble.onConnectGATT = function (uuid) {
  console.log('> connected GATT!');
  document.getElementById('uuid_name').innerHTML = uuid;
  document.getElementById('status').innerHTML = "connected GATT!";
}

ble.onWrite = function(uuid){
  document.getElementById('uuid_name').innerHTML = uuid;
  document.getElementById('status').innerHTML = "written data"
}

function sendData(value) {
  const textEncoder = new TextEncoder();
  const encodedData = textEncoder.encode(value);
  ble.write('UUID1', encodedData);
}

document.getElementById('button1').addEventListener('click', function() {
  //sendData('1');
  ble.write('UUID1', '1');
});

document.getElementById('button2').addEventListener('click', function() {
  //sendData('2');
  ble.write('UUID1', '2');
});

</script>
</body>
</html>
